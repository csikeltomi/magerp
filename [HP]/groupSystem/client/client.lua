ESX=nil;Citizen.CreateThread(function()while ESX==nil do TriggerEvent("esx:getSharedObject",function(a)ESX=a end)Citizen.Wait(0)end end)local b=nil;local c=nil;local d={}RegisterCommand('klan',function(e,f,g)ESX.TriggerServerCallback("Group:GetMyGroup",function(h)local i=h;if i.GroupID~=nil then ESX.TriggerServerCallback("Group:GetGroupPlayers",function(j)print(ESX.DumpTable(j))SendNUIMessage({action='Display',group=i,members=j})end,i.GroupID)c=i else SendNUIMessage({action='Display',group=i})end end)SetNuiFocus(true,true)end)local k='nincs'Citizen.CreateThread(function()while true do ESX.TriggerServerCallback("Group:GetFaction",function(l)k=l end)Wait(10000)end end)local m={['zold']={text="Gyógyítók",color="g"},['voros']={text="Védelmezök",color="r"},['kek']={text="Ösmágus",color="b"},['sarga']={text="Idötlenek",color="b"}}Citizen.CreateThread(function()while true do if m[k]then local n=m[k]local o=string.format("Vérvonal: ~%s~ %s",n.color,n.text)SetTextFont(0)SetTextProportional(0)SetTextScale(0.5,0.25)SetTextColour(255,255,255,255)SetTextDropshadow(0,0,0,0,255)SetTextEdge(1,0,0,0,255)SetTextDropShadow()SetTextOutline()SetTextJustification(1)SetTextEntry("STRING")AddTextComponentString(o)DrawText(0.86,0.90)ClearDrawOrigin()end;Wait(0)end end)RegisterNetEvent("Group:CastSelector")AddEventHandler("Group:CastSelector",function()SendNUIMessage({action='cast'})SetNuiFocus(true,true)end)RegisterNetEvent("Group:UpdateClan")AddEventHandler("Group:UpadateClan",function()ESX.TriggerServerCallback("Group:GetMyGroup",function(h)local i=h;if i.GroupID~=nil then ESX.TriggerServerCallback("Group:GetGroupPlayers",function(j)print(ESX.DumpTable(j))SendNUIMessage({action='Display',group=i,members=j})end,i.GroupID)c=i else SendNUIMessage({action='Display',group=i})end end)end)Citizen.CreateThread(function()while true do ESX.TriggerServerCallback("Group:GetMyGroup",function(h)local i=h;if i.GroupID~=nil then ESX.TriggerServerCallback("Group:GetGroupPlayers",function(j)d=j end,i.GroupID)else d={}end end)Wait(10000)end end)local p={}local q={}Citizen.CreateThread(function()while true do q={}local r=PlayerPedId()local s=GetEntityCoords(r)for t,u in pairs(d)do local v=u.serverId;local w=GetPlayerPed(GetPlayerFromServerId(v))if HasEntityClearLosToEntity(PlayerPedId(),w,17)then local x=#(s-GetEntityCoords(w))q[v]=x end end;Wait(1000)end end)function loadAllIcons()local y=CreateRuntimeTxd("GroupIcon")CreateRuntimeTextureFromImage(y,"GroupIcon","GroupIcon.png")end;local z=30.0;Citizen.CreateThread(function()while true do for v,x in pairs(q)do local w=GetPlayerPed(GetPlayerFromServerId(v))if true then if x<z and PlayerPedId()~=w then local A=GetEntityCoords(w)DrawImage3D('meows','woof',A.x,A.y,A.z+1.0,0.05,0.05,90.0,0,0,255,255)end end end;Wait(0)end end)function DrawText3D(B,C,D,E,F,G)local H,I,J=World3dToScreen2d(B.x,B.y,B.z+1.2)local K=#(GetGameplayCamCoords()-B)local L=1/K*G;local M=1/GetGameplayCamFov()*100;local L=L*M;if H then if not useCustomScale then SetTextScale(0.0*L,0.55*L)else SetTextScale(0.0*L,customScale)end;SetTextFont(0)SetTextProportional(1)SetTextColour(D,E,F,255)SetTextDropshadow(0,0,0,0,255)SetTextEdge(2,0,0,0,150)SetTextDropShadow()SetTextOutline()SetTextEntry("STRING")SetTextCentre(1)local N=GetTextScaleHeight(0.0*L,0.55*L)local O=EndTextCommandGetWidth(4)DrawRect(I,J,O,N,255,255,255,200)AddTextComponentString(C)DrawText(I,J)end end;function DrawImage3D(P,Q,R,S,T,O,N,U,D,E,F,V)local H,I,J=World3dToScreen2d(R,S,T)local W,X,Y=table.unpack(GetGameplayCamCoords())local K=GetDistanceBetweenCoords(W,X,Y,R,S,T,true)if H then local O=1/K*O;local N=1/K*N;local M=1/GetGameplayCamFov()*100;local O=O*M;local N=N*M;local Z=GetEntityCoords(PlayerPedId(),true)local _=StartShapeTestRay(Z.x,Z.y,Z.z,R,S,T,-1,PlayerPedId(),0)local t,t,t,t,a0=GetShapeTestResult(_)if a0==0 or a0==nil then DrawSprite(P,Q,I,J,O,N,U,D,E,F,V)end end end;RegisterNetEvent("Group:ClanInvite")AddEventHandler("Group:ClanInvite",function(v)b=v end)RegisterNUICallback('Close',function()SetNuiFocus(false,false)end)RegisterNUICallback('Create',function(o)TriggerServerEvent("Group:CreateClan",o.name,o.date)end)RegisterNUICallback('Invite',function(o)TriggerServerEvent("Group:InviteClan",o.name,c)end)RegisterNUICallback('Kick',function(o)TriggerServerEvent("Group:KickClan",o.name,c)end)RegisterNUICallback('Leave',function()TriggerServerEvent("Group:LeavenClan",c)end)RegisterCommand('elfogad',function(e,f,g)TriggerServerEvent("Group:JoinClan",b)b=nil end)RegisterNUICallback('SaveCsapat',function(o)TriggerServerEvent("Group:HQWarTeamSetup",c.GroupID,o.teamsetup)end)RegisterNUICallback('DeclareWar',function(o)TriggerServerEvent("Group:DeclareHQWar",c.GroupID,o.hq)end)RegisterNUICallback('SelectCast',function(o)TriggerServerEvent("Group:SelectCast",o.cast)end)
