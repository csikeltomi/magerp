ESX=nil;local a=false;Citizen.CreateThread(function()while ESX==nil do TriggerEvent("esx:getSharedObject",function(b)ESX=b end)Citizen.Wait(0)end end)RegisterNetEvent("SepruMenu:Open")AddEventHandler("SepruMenu:Open",function()local c={{label='Seprű',value='SEPRU'}}ESX.TriggerServerCallback("SepruMenu:GetCars",function(d)local e=nil;e=ESX.GetPlayerData()while e==nil do e=ESX.GetPlayerData()Wait(100)end;if e.job.name=='magiaugy'then a=true else a=false end;for f,g in pairs(d)do print(ESX.DumpTable(g.rendszam))table.insert(c,{label=g.name.." - "..g.rendszam,plate=g.rendszam,name=g.name,value=g.vehicle})end;if a then local h={model=GetHashKey('police2')}table.insert(c,{label="Munkajármű",plate="",name="police2",value=json.encode(h)})end;ESX.UI.Menu.Open('default',GetCurrentResourceName(),'gondolat_menu',{title="Jarmuvek",align='top-left',elements=c},function(h,i)local j=h.current.value;if j=="SEPRU"then selected_vehicle="SEPRU"else selected_vehicle={plate=h.current.plate,vehicle=h.current.value}end;i.close()end,function(h,i)i.close()end)end)end)RegisterNetEvent("SepruMenu:UpdateCurrent")AddEventHandler("SepruMenu:UpdateCurrent",function(j,k)if selected_vehicle.plate==k then selected_vehicle.vehicle=j;print(ESX.DumpTable(j))end end)function SpawnVehicle2(l,k,m,n,o)local j=json.decode(l)print(ESX.DumpTable(j))ESX.Game.SpawnVehicle(j.model,m,n,function(p)ESX.Game.SetVehicleProperties(p,j)SetVehRadioStation(p,"OFF")SetVehicleFixed(p)SetVehicleDeformationFixed(p)SetVehicleUndriveable(p,false)SetVehicleEngineOn(p,true,true)SetEntityAsMissionEntity(p,true,false)SetVehicleNumberPlateText(p,tostring(GetPlayerServerId(PlayerId())))o(p)end)end
